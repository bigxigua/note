(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){e.exports=n(224)},142:function(e,t,n){},143:function(e,t,n){},163:function(e,t,n){},209:function(e,t,n){},219:function(e,t,n){},224:function(e,t,n){"use strict";n.r(t);var a=n(27),o=n(28),r=n(32),s=n(29),i=n(33),c=n(0),l=n.n(c),u=n(4),d=n.n(u),m=n(128),p=n(47),f=n(77),h=n(45),b=n(121),v={userInfo:{}};var g={saveStatus:"initial",markdownInfo:{}};var w=Object(h.c)({userReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_USER_INFO":return Object.assign({},e,{userInfo:t.userInfo});default:return e}},editorReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTO_SAVE_MARKDOWN_STATUS":return Object.assign({},e,{saveStatus:t.status});case"SET_INIT_MRKDOWN_CONTENT":return Object.assign({},e,{markdownInfo:t.markdownInfo});default:return e}}}),k=Object(h.d)(w,Object(h.a)(b.a)),E=(n(141),n(142),n(143),n(17)),_=n.n(E),y=n(48),O=n(35),I=n(227),S=n(230),N=n(228),j=n(9),C=n(19),M=n(229),x=n(226),T=n(225),H=n(54),U=n(130),A=n(122),D=n.n(A).a.create({baseURL:"http://127.0.0.1:8080/",timeout:3e3,withCredentials:!0,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json; charset=utf-8"},params:{},data:{}});D.interceptors.request.use(function(e){return e},function(e){Promise.reject(e)}),D.interceptors.response.use(function(e){return e&&e.data&&"success"===e.data.status?[null,e.data.data]:[e.data,null]},function(e){return Promise.reject(e)});var L=D,R=(n(163),function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).onInputHandle=function(e){var t=e.currentTarget,a=t.type,o=t.value;"text"===a?n.setState({account:o}):n.setState({password:o})},n.state={showModal:!1,account:"",password:"",loading:!1},n.doLogin=n.doLogin.bind(Object(H.a)(n)),n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.setState({showModal:!0})}},{key:"doLogin",value:function(){var e=Object(O.a)(_.a.mark(function e(n){var a,o,r,s,i,c,l,u,d=arguments;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>1&&void 0!==d[1]&&d[1],o=this.state||{},r=o.account,s=o.password,a||this.setState({loading:!0}),e.prev=3,e.next=6,L.post("login",{account:r,password:s});case 6:i=e.sent,c=Object(y.a)(i,2),l=c[0],u=c[1],!l&&u?(t.emit("login:change",u),!a&&this.setState({showModal:!1})):(t.emit("login:change",null),S.a.error(l.message)),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),S.a.error("\u7cfb\u7edf\u7e41\u5fd9"),t.emit("login:change",null);case 17:return e.prev=17,!a&&this.setState({loading:!1}),e.finish(17);case 20:return e.abrupt("return",{});case 21:case"end":return e.stop()}},e,this,[[3,13,17,20]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.account,n=e.password,a=e.loading;return l.a.createElement("div",{className:"login_container"},l.a.createElement(x.a,{title:"\u571f\u5ddd\u8bb0",centered:!0,confirmLoading:!0,destroyOnClose:!0,visible:this.state.showModal,footer:[l.a.createElement(C.a,{key:"submit",type:"primary",onClick:this.doLogin,className:"login_submit_btn",loading:a,disabled:!n||!t},"\u767b\u5f55")]},l.a.createElement(T.a,{placeholder:"\u8bf7\u8f93\u5165\u8d26\u53f7",className:"login_input",prefix:l.a.createElement(j.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),onChange:this.onInputHandle,value:t,type:"accont",suffix:l.a.createElement(U.a,{title:"\u90ae\u7bb1/\u624b\u673a\u53f7/\u6635\u79f0\u5747\u53ef"},l.a.createElement(j.a,{type:"info-circle",style:{color:"rgba(0,0,0,.45)"}}))}),l.a.createElement(T.a.Password,{placeholder:"\u8f93\u5165\u5bc6\u7801",className:"login_input",onChange:this.onInputHandle,value:n})))}}]),t}(c.Component));R.listen=function(e,t){var n=R.listeners;n[e]||(n[e]=[]),n[e].push(t)},R.emit=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=R.listeners;n[e]&&n[e].forEach(function(e){e(t)})},R.hide=function(){R.loginElement.classList.add("login_box_hide")},R.checkAuthorization=Object(O.a)(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:R.prototype.doLogin({},!0);case 1:case"end":return e.stop()}},e)})),R.createInstance=function(e){var t=document.getElementById("login_box");return R.loginElement=t,t?t.classList.remove("login_box_hide"):((t=document.createElement("div")).setAttribute("id","login_box"),document.body.appendChild(t),d.a.render(l.a.createElement(R,e||{}),t)),{destroy:function(){d.a.unmountComponentAtNode(t),document.body.removeChild(t)},hide:function(){t.classList.add("login_box_hide")}}},R.listeners={};n(209);var V=[{title:"\u83dc\u5355",href:"",subItems:[{href:"",content:"222"}]}];function B(e){var t=e.map(function(e){return l.a.createElement(I.b.Item,{key:e.content},l.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.href},e.content))});return l.a.createElement(I.b,null,t)}var P=I.b.SubMenu,K=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).doLogin=function(){var e=R.createInstance();R.listen("login:change",function(t){t&&(e.hide(),n.props.updateUserInfo(t))})},n.onDrawerOpenHandle=function(){n.setState({drawerVisibled:!0}),n.onGetUserNotes()},n.onGetUserNotes=Object(O.a)(_.a.mark(function e(){var t,a,o,r;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.get("getUserNotes");case 2:t=e.sent,a=Object(y.a)(t,2),o=a[0],r=a[1],!o&&Array.isArray(r)?n.setState({notes:r}):S.a.error((o||{}).message||"\u83b7\u53d6\u7b14\u8bb0\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),console.log(o,r);case 8:case"end":return e.stop()}},e)})),n.onSubNoteTitleClick=function(e){n.props.setInitMarkdownContent(e.item.props.item),n.onDrawerCloseHandle()},n.onDrawerCloseHandle=function(){n.setState({drawerVisibled:!1})},n.onInputValueChange=function(e){var t=e.currentTarget.value.trim();n.setState({noteBookName:t})},n.onCreateNewNotebook=Object(O.a)(_.a.mark(function e(){var t,a,o,r,s,i,c;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state,a=t.noteBookName,o=t.notes,e.next=3,L.post("createNotebook",{noteBookName:a});case 3:r=e.sent,s=Object(y.a)(r,2),i=s[0],c=s[1],!i&&c?(n.onHideModalHandle(),o.push(c),S.a.success("\u521b\u5efa\u7b14\u8bb0\u672c\u6210\u529f\uff0c\u73b0\u5728\u53ef\u4ee5\u8bb0\u7b14\u8bb0\u5566"),n.setState({notes:o})):S.a.error((i||{}).message||"\u7cfb\u7edf\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5"),console.log(i,c);case 9:case"end":return e.stop()}},e)})),n.onHideModalHandle=function(){n.setState({modalVisibled:!1})},n.onShowModalHandle=Object(O.a)(_.a.mark(function e(){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.setState({modalVisibled:!0});case 1:case"end":return e.stop()}},e)})),n.state={drawerVisibled:!1,modalVisibled:!1,noteBookName:"",notes:[],wastepaperBaskets:[]},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=V.map(function(e){return l.a.createElement(N.a,{overlay:B(e.subItems),key:e.title},l.a.createElement("a",{className:"right_munu-dropdown-link",href:"#"},e.title,l.a.createElement(j.a,{type:"down"})))}),n=this.props,a=n.saveStatus,o=n.userInfo.account,r=this.state,s=r.notes,i=r.wastepaperBaskets,c={initial:"",pendding:l.a.createElement(j.a,{type:"loading",className:"right_munu_icon right_munu_loading"}),success:l.a.createElement(j.a,{type:"check",className:"right_munu_icon right_munu_success"}),failed:l.a.createElement(j.a,{type:"close",className:"right_munu_icon right_munu_failed"})},u=s.map(function(t){return l.a.createElement(P,{key:t.notebook_id,title:l.a.createElement("span",null,l.a.createElement(j.a,{type:"book"}),l.a.createElement("span",null,t.notebook_name))},(t.subNotes||[]).map(function(t){return l.a.createElement(I.b.Item,{onClick:e.onSubNoteTitleClick,item:t,key:t.sub_note_id},t.sub_note_title)}))});return l.a.createElement("div",{className:"nav_container"},l.a.createElement("div",{className:"left_munu"},"\u571f\u5ddd\u8bb0"),l.a.createElement("div",{className:"right_munu"},o&&l.a.createElement(C.a,{type:"primary",onClick:this.onDrawerOpenHandle},"\u6211\u7684\u7b14\u8bb0\u672c"),t,c[a],!o&&l.a.createElement(C.a,{className:"right_munu_btn",onClick:this.doLogin},"\u767b\u9646")),l.a.createElement(M.a,{title:"\u571f\u5ddd\u8bb0",placement:"left",closable:!1,onClose:this.onDrawerCloseHandle,visible:this.state.drawerVisibled},l.a.createElement(I.b,{onClick:this.handleClick,style:{width:256},defaultOpenKeys:["sub1"],selectedKeys:[this.state.current],mode:"inline"},l.a.createElement(I.b.Item,{key:"editor",className:"drawer_munu_note"},l.a.createElement("div",null,l.a.createElement(j.a,{type:"mail"}),"\u7b14\u8bb0\u672c"),l.a.createElement(j.a,{type:"plus-circle",onClick:this.onShowModalHandle})),u,l.a.createElement(I.b.Item,{key:"basket",className:"drawer_munu_basket"},l.a.createElement(j.a,{type:"delete"}),"\u5e9f\u7eb8\u7bd3(",i.length||0,")"))),l.a.createElement(x.a,{title:"\u65b0\u5efa\u7b14\u8bb0\u672c",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:this.state.modalVisibled,onOk:this.onCreateNewNotebook,onCancel:this.onHideModalHandle},l.a.createElement(T.a,{onChange:this.onInputValueChange,size:"large",placeholder:"\u8bf7\u8f93\u5165\u7b14\u8bb0\u540d\u79f0"}),l.a.createElement("p",{className:"nav_create_note_tip"},"\u66f4\u591a\u7279\u6027,\u656c\u8bf7\u671f\u5f85...")))}}]),t}(c.Component);n(219);var W=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).autoSaveHandle=function(){var e=Object(O.a)(_.a.mark(function e(t){var a,o,r,s,i,c,l,u;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.props.userInfo.account){e.next=4;break}return n.toggleShowModal(!0),e.abrupt("return");case 4:return o=t.getMarkdown(),r=t.previewContainer.html(),s=n.props.markdownInfo.sub_note_id,e.prev=7,e.next=10,L.post("updateDraft",{html:r,markdown:o,subNoteId:s});case 10:i=e.sent,c=Object(y.a)(i,2),l=c[0],u=c[1],l?(S.a.error(u.message),n.props.autoSaveMarkdown("failed")):(window.localStorage.setItem(a,o),n.props.autoSaveMarkdown("success")),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(7),S.a.error(e.t0.message),n.props.autoSaveMarkdown("failed");case 21:case"end":return e.stop()}},e,null,[[7,17]])}));return function(t){return e.apply(this,arguments)}}(),n.setPatternToExemption=function(){n.toggleShowModal(!1)},n.doLogin=function(){n.toggleShowModal(!1),R.createInstance()},n.toggleShowModal=function(e){n.setState({showModal:e}),n.props.autoSaveMarkdown("")},n.state={showModal:!1,editor:null},n}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window,n=t.$,a=t.editormd,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=null,o=n;return function(){var n=this,r=arguments;o?(e.apply(this,arguments),o=!1):(clearTimeout(a),a=setTimeout(function(){e.apply(n,r)},t))}}(function(){this.autoSaveHandle.apply(this,arguments)}).bind(this);R.checkAuthorization(),R.listen("login:change",function(t){t&&e.props.updateUserInfo(t)}),n(function(){var t=a("editormd",{path:"/editor/lib/",disabledKeyMaps:["Ctrl-B","F11","F10"],placeholder:"\u5f00\u59cb\u5427\uff01\uff01",onload:function(){}});e.setState({editor:t}),t.settings.onchange=function(){this.props.autoSaveMarkdown("pendding"),o(t)}.bind(e)})}},{key:"componentWillReceiveProps",value:function(e){var t=e.markdownInfo,n=this.props.markdownInfo.sub_note_markdown,a=t.sub_note_markdown;a&&a!==n&&this.state.editor.setMarkdown(a)}},{key:"render",value:function(){return l.a.createElement("div",{className:"editor_container",id:"editormd"},l.a.createElement(x.a,{title:"\u767b\u9646\u540e\u53ef\u4ee5\u6c38\u4e45\u4fdd\u5b58\u54df",okText:"\u514d\u767b\u9646\u6a21\u5f0f",cancelText:"\u53bb\u767b\u9646",visible:this.state.showModal,onOk:this.setPatternToExemption,onCancel:this.doLogin},l.a.createElement("p",null,"1.\u767b\u9646\u540e\u53ef\u4ee5\u6c38\u4e45\u4fdd\u5b58\u7f16\u8f91\u5185\u5bb9"),l.a.createElement("p",null,"2.\u514d\u767b\u9646\u6a21\u5f0f\u8ba9\u4f60\u5feb\u901f\u7f16\u8f91\u6587\u6863\uff0c\u5237\u65b0\u4e0d\u4e22\u7684\u54df"),l.a.createElement("p",null,"\xa0\xa0\xa0\u66f4\u591a\u7279\u6027,\u656c\u8bf7\u671f\u5f85...")))}}]),t}(c.Component),F=function(e){function t(e){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).call(this,e))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.autoSaveMarkdown,n=e.updateUserInfo,a=e.setInitMarkdownContent,o=e.saveStatus,r=e.userInfo,s=e.markdownInfo;return l.a.createElement("div",{className:"page_container"},l.a.createElement(K,{saveStatus:o,userInfo:r,setInitMarkdownContent:a,updateUserInfo:n}),l.a.createElement(W,{updateUserInfo:n,markdownInfo:s,setInitMarkdownContent:a,autoSaveMarkdown:t,userInfo:r}))}}]),t}(c.Component),q=function(e){return{type:"AUTO_SAVE_MARKDOWN_STATUS",status:e}},z=function(e){return{type:"SET_INIT_MRKDOWN_CONTENT",markdownInfo:e}},G=function(e){return{type:"UPDATE_USER_INFO",userInfo:e}};var J=Object(f.b)(function(e){return{userInfo:e.userReducer.userInfo,saveStatus:e.editorReducer.saveStatus,markdownInfo:e.editorReducer.markdownInfo}},function(e){return{updateUserInfo:function(t){e(G(t))},setInitMarkdownContent:function(t){e(z(t))},autoSaveMarkdown:function(t){e(q(t))}}})(F),X=function(e){function t(e){return Object(a.a)(this,t),Object(r.a)(this,Object(s.a)(t).call(this,e))}return Object(i.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(m.a,null,l.a.createElement("div",{className:"container"},l.a.createElement(p.a,{exact:!0,path:"/",component:J}))))}}]),t}(l.a.Component);d.a.render(l.a.createElement(f.a,{store:k},l.a.createElement("div",null,l.a.createElement(X,null))),document.getElementById("root"))}},[[132,1,2]]]);
//# sourceMappingURL=main.9d11d1f2.chunk.js.map